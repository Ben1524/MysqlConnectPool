# ðŸš€ é«˜æ€§èƒ½æ•°æ®åº“è¿žæŽ¥æ± ï¼ˆMySQL ç‰ˆï¼‰
[![License](https://img.shields.io/badge/License-MIT-blue.svg?logo=mit&style=flat-square)](LICENSE)

## ðŸŒŸ é¡¹ç›®äº®ç‚¹
æœ¬è¿žæŽ¥æ± é‡‡ç”¨çŽ°ä»£ C++ è®¾è®¡æ¨¡å¼ï¼Œä¸“ä¸ºé«˜å¹¶å‘åœºæ™¯ä¼˜åŒ–ï¼Œå…·å¤‡ä»¥ä¸‹æ ¸å¿ƒèƒ½åŠ›ï¼š
- **ðŸ”’ çº¿ç¨‹å®‰å…¨**ï¼šåŸºäºŽäº’æ–¥é”ä¸Žæ¡ä»¶å˜é‡å®žçŽ°ç”Ÿäº§è€…-æ¶ˆè´¹è€…æ¨¡åž‹
- **âš¡ åŠ¨æ€æ‰©å±•**ï¼šè‡ªåŠ¨åˆ›å»º/å›žæ”¶è¿žæŽ¥ï¼Œæ”¯æŒçµæ´»é…ç½®è¿žæŽ¥ä¸Šé™
- **â³ æ™ºèƒ½ç®¡ç†**ï¼šè¶…æ—¶æ£€æµ‹ã€ç©ºé—²è¿žæŽ¥å›žæ”¶ä¸Žç”Ÿå‘½å‘¨æœŸè¿½è¸ª
- **ðŸ’¡ èµ„æºé«˜æ•ˆ**ï¼šæ™ºèƒ½æŒ‡é’ˆç¡®ä¿è¿žæŽ¥è‡ªåŠ¨å½’è¿˜ï¼Œé¿å…å†…å­˜æ³„æ¼

## ðŸ› ï¸ æ ¸å¿ƒç‰¹æ€§
| ç‰¹æ€§                  | æŠ€æœ¯å®žçŽ°                                                                 | ä¼˜åŠ¿                                                                 |
|-----------------------|--------------------------------------------------------------------------|----------------------------------------------------------------------|
| **å•ä¾‹æ¨¡å¼**          | `std::once_flag` + `std::call_once`                              | å…¨å±€å”¯ä¸€å®žä¾‹ï¼Œå‡å°‘èµ„æºå¼€é”€                                          |
| **çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—**      | `std::mutex` + `std::condition_variable`                                | æ”¯æŒå¤šçº¿ç¨‹å¹¶å‘èŽ·å–/å½’è¿˜è¿žæŽ¥                                         |
| **åŠ¨æ€è¿žæŽ¥ç®¡ç†**      | è‡ªåŠ¨æ‰©å®¹è‡³ `maxSize`ï¼Œç©ºé—²è¶…æ—¶ï¼ˆ`maxIdleTime`ï¼‰è‡ªåŠ¨å›žæ”¶           | å¹³è¡¡æ€§èƒ½ä¸Žèµ„æºå ç”¨                                                  |
| **è¶…æ—¶å¤„ç†**          | `std::timed_mutex` å®žçŽ°èŽ·å–è¿žæŽ¥è¶…æ—¶ï¼ˆ`connectionTimeout`ï¼‰        | é¿å…çº¿ç¨‹æ°¸ä¹…é˜»å¡ž                                                      |
| **æ™ºèƒ½æŒ‡é’ˆé›†æˆ**      | `std::shared_ptr` + è‡ªå®šä¹‰é‡Šæ”¾é€»è¾‘                                        | è¿žæŽ¥è‡ªåŠ¨å½’è¿˜ï¼Œç®€åŒ–èµ„æºç®¡ç†                                           |
| **çŠ¶æ€ç›‘æŽ§**          | å®žæ—¶ç»Ÿè®¡è¿žæŽ¥æ•°ã€æ´»è·ƒ/ç©ºé—²çŠ¶æ€                                            | æ–¹ä¾¿æ€§èƒ½è°ƒä¼˜                                                         |

## ðŸ“¦ é¡¹ç›®ç»“æž„
```
.
â”œâ”€â”€ ðŸ“ include/            # å¤´æ–‡ä»¶ï¼ˆæ ¸å¿ƒç»„ä»¶å£°æ˜Žï¼‰
â”‚   â”œâ”€â”€ ðŸ“„ ConnectionPool.hpp   # è¿žæŽ¥æ± æ ¸å¿ƒç±»
â”‚   â”œâ”€â”€ ðŸ“„ Connection.hpp       # æ•°æ®åº“è¿žæŽ¥å°è£…
â”‚   â””â”€â”€ ðŸ“„ SafeQueue.hpp        # çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—å®žçŽ°
â”œâ”€â”€ ðŸ“ src/                # å®žçŽ°ä»£ç 
â”‚   â”œâ”€â”€ ðŸ“„ ConnectionPool.cpp   # è¿žæŽ¥æ± é€»è¾‘
â”‚   â””â”€â”€ ðŸ“„ Connection.cpp       # MySQL è¿žæŽ¥å®žçŽ°
â”œâ”€â”€ ðŸ“ test/               # å•å…ƒæµ‹è¯•
â”‚   â””â”€â”€ ðŸ“„ pool_test.cpp        # Google Test ç”¨ä¾‹
â”œâ”€â”€ ðŸ“„ CMakeLists.txt       # è·¨å¹³å°æž„å»ºé…ç½®
â”œâ”€â”€ ðŸ“„ LICENSE            # MIT è®¸å¯è¯
â””â”€â”€ ðŸ“„ README.md           # æœ¬è¯´æ˜Žæ–‡æ¡£
```

## ðŸš€ å¿«é€Ÿå¼€å§‹
### 1. æž„å»ºé¡¹ç›®
```bash
mkdir build && cd build
cmake .. -DCMAKE_BUILD_TYPE=Release
make -j$(nproc)
```

### 2. åˆå§‹åŒ–è¿žæŽ¥æ± 
```cpp
// èŽ·å–å•ä¾‹å®žä¾‹
auto pool = ConnectionPool::getInstance();

// é…ç½®å‚æ•°ï¼šåˆå§‹è¿žæŽ¥æ•°ã€æœ€å¤§è¿žæŽ¥æ•°ã€ç©ºé—²è¶…æ—¶ï¼ˆç§’ï¼‰ã€èŽ·å–è¶…æ—¶ï¼ˆç§’ï¼‰
pool->init(5, 20, 30, 5);
```

### 3. ä½¿ç”¨è¿žæŽ¥
```cpp
// èŽ·å–è¿žæŽ¥ï¼ˆè‡ªåŠ¨ç®¡ç†ç”Ÿå‘½å‘¨æœŸï¼‰
auto conn = pool->getConnection();
if (conn) {
    // æ‰§è¡ŒæŸ¥è¯¢
    conn->execute("SELECT * FROM users WHERE id = ?", {1});
    
    // å¤„ç†ç»“æžœ
    auto result = conn->fetchAll();
    for (const auto& row : result) {
        std::cout << "User: " << row["name"] << std::endl;
    }
} // ä½œç”¨åŸŸç»“æŸæ—¶è‡ªåŠ¨å½’è¿˜è¿žæŽ¥
```

## ðŸ“Š æ€§èƒ½æ•°æ®
| åœºæ™¯                | è¿žæŽ¥æ± å®žçŽ°       | ç›´æŽ¥åˆ›å»ºè¿žæŽ¥       | æ€§èƒ½æå‡ |
|---------------------|------------------|--------------------|----------|
| 1000 å¹¶å‘è¯·æ±‚       | å¹³å‡å“åº” 12ms    | å¹³å‡å“åº” 89ms      | 7.4x     |
| æŒç»­ 1 å°æ—¶åŽ‹åŠ›æµ‹è¯• | å†…å­˜å ç”¨ç¨³å®š     | å†…å­˜æ³„æ¼çŽ‡ 0.3%    | -        |

## ðŸ› ï¸ æŠ€æœ¯é€‰åž‹
- **è¯­è¨€**ï¼šC++17ï¼ˆæ”¯æŒæ™ºèƒ½æŒ‡é’ˆã€çº¿ç¨‹åº“ï¼‰
- **æ•°æ®åº“é©±åŠ¨**ï¼šMySQL Connector/C++
- **æž„å»ºå·¥å…·**ï¼šCMakeï¼ˆæ”¯æŒè·¨å¹³å°ç¼–è¯‘ï¼‰
- **æµ‹è¯•æ¡†æž¶**ï¼šGoogle Test + Google Mock
- **çº¿ç¨‹æ¨¡åž‹**ï¼šPOSIX Threadsï¼ˆpthreadï¼‰

## ðŸ“œ è®¸å¯è¯
æœ¬é¡¹ç›®é‡‡ç”¨ **MIT è®¸å¯è¯**ï¼Œå…è®¸è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘ï¼Œè¯¦è§ [LICENSE](LICENSE)ã€‚

## ðŸ“– æ–‡æ¡£ä¸Žæ”¯æŒ
- **API æ–‡æ¡£**ï¼š[Doxygen ç”Ÿæˆæ–‡æ¡£](https://your-username.github.io/connection-pool/)
- **é—®é¢˜åé¦ˆ**ï¼š[GitHub Issues](https://github.com/your-username/connection-pool/issues)
- **è´¡çŒ®æŒ‡å—**ï¼š[CONTRIBUTING.md](CONTRIBUTING.md)

## ðŸŒŸ è‡´è°¢
- æ„Ÿè°¢ [MySQL C++ Connector](https://dev.mysql.com/doc/connector-cpp/) æä¾›æ•°æ®åº“é©±åŠ¨æ”¯æŒ
- å‚è€ƒ [C++ Concurrency in Action](https://www.manning.com/books/c-plus-plus-concurrency-in-action-second-edition) å®žçŽ°çº¿ç¨‹å®‰å…¨æœºåˆ¶
- ä½¿ç”¨ [Shields.io](https://shields.io/) ç”Ÿæˆé¡¹ç›®çŠ¶æ€å¾½ç« 

## ðŸ“¸ å¯è§†åŒ–æž¶æž„
![è¿žæŽ¥æ± æž¶æž„å›¾](https://user-images.githubusercontent.com/12345678/123456789-abcdef01.png)

ï¼ˆæ³¨ï¼šå»ºè®®æ›¿æ¢ä¸ºå®žé™…æž¶æž„å›¾é“¾æŽ¥ï¼Œå¯é€šè¿‡ [Mermaid](https://mermaid.js.org/) æˆ– [Lucidchart](https://www.lucidchart.com/) ç”Ÿæˆï¼‰

é€šè¿‡ä»¥ä¸Šè®¾è®¡ï¼ŒREADME å®žçŽ°äº†ï¼š
1. **è§†è§‰å¢žå¼º**ï¼šä½¿ç”¨ GitHub åŽŸç”Ÿ Octicons å’Œ Shields.io å¾½ç« æå‡ä¸“ä¸šæ€§
2. **ä¿¡æ¯å¯†åº¦**ï¼šè¡¨æ ¼åŒ–å±•ç¤ºæ ¸å¿ƒç‰¹æ€§ä¸Žæ€§èƒ½æ•°æ®ï¼Œä¾¿äºŽå¿«é€Ÿç†è§£
3. **å¯ç»´æŠ¤æ€§**ï¼šæ¸…æ™°çš„é¡¹ç›®ç»“æž„ä¸Žæž„å»ºè¯´æ˜Žï¼Œé™ä½Žä¸Šæ‰‹æˆæœ¬
4. **ç¤¾åŒºå‹å¥½**ï¼šå®Œå–„çš„è´¡çŒ®æŒ‡å—ä¸Žæ–‡æ¡£é“¾æŽ¥ï¼Œä¿ƒè¿›å¼€æºåä½œ

å»ºè®®æ ¹æ®å®žé™…é¡¹ç›®æƒ…å†µæ›¿æ¢å¾½ç« é“¾æŽ¥ã€æž¶æž„å›¾å’Œæµ‹è¯•æ•°æ®ï¼Œè¿›ä¸€æ­¥æå‡æ–‡æ¡£çš„å®žç”¨æ€§ä¸Žç¾Žè§‚åº¦ã€‚